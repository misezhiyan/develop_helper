"use strict";(self["webpackChunkvue"]=self["webpackChunkvue"]||[]).push([[71],{4071:function(e,l,t){t.r(l),t.d(l,{default:function(){return p}});var i=t(3396),o=t(7139);const a=(0,i._)("br",null,null,-1);function s(e,l,t,s,d,r){const n=(0,i.up)("el-table-column"),c=(0,i.up)("el-table"),p=(0,i.up)("el-form-item"),m=(0,i.up)("el-option"),b=(0,i.up)("el-select"),u=(0,i.up)("el-button"),h=(0,i.up)("el-form"),g=(0,i.up)("el-dialog");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Uk)(" 代码生成 1、选择项目 2、项目关联数据库，关联模板生成策略 3、使用策略，带出表列表，选择多个表之后，批量生成后端代码 "),(0,i.Wm)(c,{data:d.projectList,onRowDblclick:r.projDbClickRow},{default:(0,i.w5)((()=>[(0,i.Wm)(n,{prop:"id",label:"id"}),(0,i.Wm)(n,{prop:"projectName",label:"项目名称"}),(0,i.Wm)(n,{prop:"baseUrl",label:"项目基本路径"}),(0,i.Wm)(n,{prop:"createTime",label:"创建时间"})])),_:1},8,["data","onRowDblclick"]),(0,i.Wm)(g,{modelValue:d.projDialogModel,"onUpdate:modelValue":l[3]||(l[3]=e=>d.projDialogModel=e),width:"80%"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{modelValue:d.projForm,"onUpdate:modelValue":l[2]||(l[2]=e=>d.projForm=e)},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{lable:"projName"},{default:(0,i.w5)((()=>[(0,i._)("span",null,"项目名称："+(0,o.zw)(d.projForm.projectName),1),a])),_:1}),(0,i.Wm)(p,{lable:"数据库表选择"},{default:(0,i.w5)((()=>[(0,i.Wm)(b,{modelValue:d.dbId,"onUpdate:modelValue":l[0]||(l[0]=e=>d.dbId=e),filterable:"",onChange:r.loadDbTables,placeholder:"选择数据库"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(d.projForm.dbList,(e=>((0,i.wg)(),(0,i.j4)(m,{key:e.id,label:e.nickName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),d.dbId?((0,i.wg)(),(0,i.j4)(b,{key:0,filterable:"",modelValue:d.tableName,"onUpdate:modelValue":l[1]||(l[1]=e=>d.tableName=e),onChange:r.addSelectedTables,placeholder:"选择表"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(d.tableList,(e=>((0,i.wg)(),(0,i.j4)(m,{key:e.id,label:e.tableName,value:e.tableName},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)(p,{lable:"生成策略选择"}),(0,i.Wm)(p,{lable:"已选中表"},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{data:d.selectedTableList},{default:(0,i.w5)((()=>[(0,i.Wm)(n,{prop:"dbId",label:"dbId"}),(0,i.Wm)(n,{prop:"dbNickName",label:"数据库昵称"}),(0,i.Wm)(n,{prop:"tableName",label:"表名"}),(0,i.Wm)(n,{prop:"policyId",label:"生成策略Id"}),(0,i.Wm)(n,{prop:"policyName",label:"生成策略"}),(0,i.Wm)(n,{prop:"tableOpt",label:"操作"},{default:(0,i.w5)((e=>[(0,i.Wm)(u,{onClick:l=>r.editPolicy(e.row)},{default:(0,i.w5)((()=>[(0,i.Uk)("编辑")])),_:2},1032,["onClick"]),(0,i.Wm)(u,{onClick:l=>r.delSelectedTable(e.row)},{default:(0,i.w5)((()=>[(0,i.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,i.Wm)(p,{lable:"操作"},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{onClick:r.generateFiles},{default:(0,i.w5)((()=>[(0,i.Uk)("生成文件")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"]),(0,i.Wm)(g,{modelValue:d.policyDialogModel,"onUpdate:modelValue":l[5]||(l[5]=e=>d.policyDialogModel=e),onOpen:r.openPolicyDialog,onClose:r.closePolicyDialog},{default:(0,i.w5)((()=>[(0,i.Wm)(b,{modelValue:d.policyId,"onUpdate:modelValue":l[4]||(l[4]=e=>d.policyId=e),placeholder:"选择生成策略"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(d.generatePolicyList,(e=>((0,i.wg)(),(0,i.j4)(m,{key:e.id,label:e.policyName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),(0,i.Wm)(u,{onClick:r.cancelPolicy},{default:(0,i.w5)((()=>[(0,i.Uk)("取消")])),_:1},8,["onClick"]),(0,i.Wm)(u,{onClick:r.canfirmPolicy},{default:(0,i.w5)((()=>[(0,i.Uk)("确定")])),_:1},8,["onClick"])])),_:1},8,["modelValue","onOpen","onClose"])])}t(7658);var d=t(1394),r={name:"dbCreate",data(){return{dbId:"",tableName:"",policyId:"",projectId:"",projectList:[],templateId:"",templateList:[],projDialogModel:!1,policyDialogModel:!1,projForm:{},tableList:[],selectedTableList:[],generatePolicyList:[],editTableRow:{}}},created(){this.getProjectList(),this.getTemplateList()},methods:{getProjectList:function(){(0,d.projectList)().then((e=>{"0000"==e.resCode?this.projectList=e.projectList:this.$message.error(e.resMsg)}))},getTemplateList:function(){(0,d.templateList)({}).then((e=>{"0000"==e.resCode?this.templateList=e.templateList:this.$message.error(e.resMsg)}))},projDbClickRow:function(e,l,t){this.projForm=JSON.parse(JSON.stringify(e)),this.projDialogModel=!0},loadDbTables:function(e){this.tableName="",this.tableList=[],(0,d.getTableList)({id:e}).then((e=>{"0000"==e.resCode?this.tableList=e.list:this.$message.error(e.resMsg)}))},addSelectedTables:function(e){let l="";for(let t=0;t<this.projForm.dbList.length;t++){let e=this.projForm.dbList[t];e.id==this.dbId&&(l=e.nickName)}this.selectedAlready(this.dbId,this.tableName)||this.selectedTableList.push({dbId:this.dbId,dbNickName:l,tableName:this.tableName})},selectedAlready:function(e,l){for(let t=0;t<this.selectedTableList.length;t++){let i=this.selectedTableList[t];if(i.dbId==e&&i.tableName==l)return!0}return!1},openPolicyDialog:function(){this.getgeneratePolicyList()},getgeneratePolicyList:function(){this.generatePolicyList&&this.generatePolicyList.length>0||(0,d.generatePolicyList)({}).then((e=>{"0000"==e.resCode?this.generatePolicyList=e.generatePolicyList:this.$message.error(e.resMsg)}))},closePolicyDialog:function(){this.policyId="",this.editTableRow={}},editPolicy:function(e){this.editTableRow=e,this.policyDialogModel=!0},delSelectedTable:function(e){for(let l=0;l<this.selectedTableList.length;l++)this.selectedAlready(this.selectedTableList[l].dbId,this.selectedTableList[l].tableName)&&this.selectedTableList.splice(l,1)},cancelPolicy:function(){this.policyDialogModel=!1},canfirmPolicy:function(){this.editTableRow.policyId=this.policyId;for(let e=0;e<this.generatePolicyList.length;e++)this.generatePolicyList[e].id==this.policyId&&(this.editTableRow.policyName=this.generatePolicyList[e].policyName);this.policyDialogModel=!1},generateFiles:function(){console.log(JSON.stringify(this.projForm)),(0,d.generateFiles)({projectId:this.projForm.id,generateTables:this.selectedTableList}).then((e=>{"0000"==e.resCode?this.generatePolicyList=e.generatePolicyList:this.$message.error(e.resMsg)}))}}},n=t(89);const c=(0,n.Z)(r,[["render",s]]);var p=c}}]);
//# sourceMappingURL=71.c70099f5.js.map